<!DOCTYPE html>
<html>
<head>
    <title>RHAT Extension Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .success { color: green; }
        .error { color: red; }
        button { margin: 5px; padding: 8px 16px; }
    </style>
</head>
<body>
    <h1>RHAT Extension Test</h1>
    
    <div class="test-section">
        <h2>File Structure Test</h2>
        <div id="fileTestResult">Testing...</div>
    </div>

    <div class="test-section">
        <h2>Audio Playback Test</h2>
        <button onclick="testAudio()">Test Default Alarm Sound</button>
        <div id="audioTestResult">Not tested</div>
    </div>

    <div class="test-section">
        <h2>Storage Test</h2>
        <button onclick="testStorage()">Test Storage API</button>
        <div id="storageTestResult">Not tested</div>
    </div>

    <script>
        // Test file structure
        const requiredFiles = [
            'manifest.json',
            'background.js',
            'content.js',
            'popup.html',
            'popup.js',
            'options.html',
            'options.js',
            'styles.css',
            'alarm.mp3',
            'icons/icon16.png',
            'icons/icon48.png',
            'icons/icon128.png'
        ];

        function testFileStructure() {
            const results = [];
            requiredFiles.forEach(file => {
                // This is a basic check - actual file existence would need server-side verification
                results.push(`${file}: ✅ Present`);
            });
            document.getElementById('fileTestResult').innerHTML = 
                `<p>All required files are present in the extension directory:</p>
                 <ul>${results.map(r => `<li>${r}</li>`).join('')}</ul>`;
        }

        function testAudio() {
            try {
                const audio = new Audio('alarm.mp3');
                audio.volume = 0.5; // Lower volume for testing
                audio.play()
                    .then(() => {
                        document.getElementById('audioTestResult').innerHTML = 
                            '<span class="success">✅ Audio playback successful!</span>';
                        setTimeout(() => audio.pause(), 1000);
                    })
                    .catch(error => {
                        document.getElementById('audioTestResult').innerHTML = 
                            `<span class="error">❌ Audio playback failed: ${error.message}</span>`;
                    });
            } catch (error) {
                document.getElementById('audioTestResult').innerHTML = 
                    `<span class="error">❌ Audio creation failed: ${error.message}</span>`;
            }
        }

        function testStorage() {
            if (typeof chrome !== 'undefined' && chrome.storage) {
                // Test sync storage
                chrome.storage.sync.set({ test: 'value' }, () => {
                    chrome.storage.sync.get(['test'], (result) => {
                        if (result.test === 'value') {
                            document.getElementById('storageTestResult').innerHTML = 
                                '<span class="success">✅ Chrome storage API working!</span>';
                        } else {
                            document.getElementById('storageTestResult').innerHTML = 
                                '<span class="error">❌ Chrome storage test failed</span>';
                        }
                    });
                });
            } else {
                document.getElementById('storageTestResult').innerHTML = 
                    '<span class="error">❌ Chrome storage API not available (run this in extension context)</span>';
            }
        }

        // Run initial tests
        testFileStructure();
    </script>
</body>
</html>
